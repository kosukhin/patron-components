import{give as e,SourceAll as t,value as s,Patron as r,SourceWithPool as i,GuestCast as c,PatronOnce as o}from"patron-oop";class n{constructor(e,t){this.basePath=e,this.template=t}content(t){fetch(this.basePath+"/"+this.template).then((e=>e.text())).then((s=>{e(s,t)}))}}class l{constructor(e,t,s,r,i){this.loading=e,this.basePath=t,this.currentPage=s,this.display=r,this.pageTransport=i}routes(i){const c=i.find((e=>e.default)),o=new t;s(this.basePath,new r(o.guestKey("basePath"))),s(this.currentPage,new r(o.guestKey("currentPage"))),o.value(new r((({basePath:t,currentPage:s})=>{const r=s.replace(t,""),o=i.find((e=>e.aliases&&(e.aliases.includes(s)||e.aliases.includes(r))));if(o){const r=t+o.url;if(r!==s)return void e(r,this.currentPage)}let n=i.find((e=>{if(e.url.indexOf("*")>=0){return new RegExp(e.url.replaceAll("*",".*").replaceAll("/","/")).test(r)}return e.url.replaceAll("*","")===r}));if(!n&&c&&(n=c),!n)throw new Error("No matching route in Navigation");{const s=t.replace("/#","").replace("#","").replace(/[^/]+\.html$/,"");e(!0,this.loading),this.pageTransport.get(s,n.template).content((t=>{this.display.display(t),n.page.mounted(),e(!1,this.loading)}))}})))}}class a{constructor(e){this.selector=e}display(e){const t=document.querySelector(this.selector);t&&(t.innerHTML=e)}}var u=Object.defineProperty,h=(e,t,s)=>((e,t,s)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class p{constructor(){h(this,"source");const e=location.href.replace(location.origin,"");this.source=new i(e)}give(e){return this.source.give(e),this}value(e){return this.source.value(e),e}pool(){return this.source.pool()}}class d{constructor(e,t){this.source=e;const s=document.querySelector(t);this.source.value(new r((e=>{s.value=String(e)}))),s.addEventListener("keyup",(()=>{this.give(s.value)})),s.addEventListener("change",(()=>{this.give(s.value)}))}value(e){return this.source.value(e),this}give(e){return this.source.give(e),this}pool(){return this.source.pool()}}class g{constructor(e){this.selector=e}give(e){const t=document.querySelector(this.selector);return t&&(t.style.display=e?"block":"none"),this}}class v{constructor(e){this.selector=e}give(e){const t=document.querySelector(this.selector);return t&&(t.innerText=String(e)),this}}class m{constructor(e,t){this.linkSource=e,this.basePath=t}watchClick(e,t){const s=document.querySelectorAll(e);if(!s.length)throw new Error(`Link wrapper not found for selector ${e}`);s.forEach((e=>{e.addEventListener("click",(s=>{t?e.querySelectorAll(t).forEach((e=>{s?.target!==e&&s?.currentTarget!==e||this.handleClick({preventDefault:s.preventDefault.bind(s),target:e})})):this.handleClick(s)}))}))}handleClick(e){let t=e?.target?.getAttribute("href");t||(t=e?.currentTarget?.getAttribute("href")),t&&0!==t.indexOf("http")&&(e.preventDefault(),s(this.basePath,(e=>{this.linkSource.give(e+t)})))}}class f{constructor(e,t){this.sources=e,this.selectorTemplate=t}element(s){const r=new t;this.sources.forEach((e=>{e.source.value(new c(s,r.guestKey(e.placeholder)))})),r.value(new c(s,(t=>{let r=this.selectorTemplate;Object.entries(t).map((e=>{r=r.replaceAll(e[0],e[1])}));const i=document.querySelector(r);i&&e(i,s)})))}}class y{constructor(e,t,s){this.activeClass=e,this.groupSelector=t,this.document=s}give(e){return s(this.document,new o((t=>{t.querySelectorAll(this.groupSelector).forEach((e=>{e.classList.remove(this.activeClass)})),e.classList.add(this.activeClass)}))),this}}class w{constructor(e){this.title=e}mounted(){document.title=this.title}}class b{constructor(e,t){this.title=e,this.entryPointUrl=t}mounted(){document.title=this.title,import(this.entryPointUrl).then((e=>{e.main&&e.main()}))}}export{f as ComputedElement,p as CurrentPage,b as EntryPointPage,y as GroupActiveClass,d as Input,m as Link,l as Navigation,w as Page,n as PageFetchTransport,a as RouteDisplay,v as Text,g as Visible};
//# sourceMappingURL=patron-components.min.mjs.map
