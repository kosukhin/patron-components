!function(e,t){"use strict";var r=Object.defineProperty,i=(e,t,i)=>((e,t,i)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i)(e,t+"",i);e.CurrentPage=class{constructor(){i(this,"source",new t.Source("/"));const e=location.href.replace(location.origin,"");this.source.receive(e)}receive(e){return console.log("cp receive",e),this.source.receive(e),this}receiving(e){return this.source.receiving(new t.GuestMiddle(e,(r=>{console.log("cp receiving",r),t.give({title:"Loading",url:r},e)}))),e}},e.Input=class{constructor(e,r){this.source=e;const i=document.querySelector(r);this.source.receiving(new t.Patron((e=>{i.value=String(e)}))),i.addEventListener("keyup",(()=>{this.receive(i.value)})),i.addEventListener("change",(()=>{this.receive(i.value)}))}receiving(e){return this.source.receiving(e),this}receive(e){return this.source.receive(e),this}},e.Link=class{constructor(e,t){this.linkSource=e,this.basePath=t}watchClick(e){const t=document.querySelector(e);if(!t)throw new Error(`Link wrapper not found for selector ${e}`);t.addEventListener("click",(e=>{e.preventDefault();let t=e?.target?.getAttribute("href");t||(t=e?.currentTarget?.getAttribute("href")),t&&this.basePath.receiving((e=>{this.linkSource.receive(e+t)}))}))}},e.Navigation=class{constructor(e,t,r,i,s){this.loading=e,this.basePath=t,this.currentPage=r,this.display=i,this.pageTransport=s}routes(e){const r=e.find((e=>e.default));this.firstLoad((()=>{this.currentPage.page(new t.Patron((t=>{this.loading.receive(!0),this.basePath.receiving((i=>{i=i.replace("/#","");let s="/"===t.url?i+"/":t.url;s=s.replace("#","").replace("//","/");let c=e.find((e=>i+e.url===s));!c&&r&&(c=r),c&&this.pageTransport.create(i,c.template).content((e=>{this.display.display(e),c.page.mounted(),this.loading.receive(!1)}))}))})))}))}firstLoad(e){const r=new t.GuestChain;this.basePath.receiving(r.receiveKey("basePath")),this.currentPage.page(r.receiveKey("currentPage")),r.result((()=>{t.give(null,e)}))}},e.Page=class{constructor(e){this.title=e}mounted(){document.title=this.title}},e.PageFetchTransport=class{constructor(e,t){this.basePath=e,this.template=t}content(e){fetch(this.basePath+"/"+this.template).then((e=>e.text())).then((r=>{t.give(r,e)}))}},e.RouteDisplay=class{constructor(e){this.selector=e}display(e){const t=document.querySelector(this.selector);t&&(t.innerHTML=e)}},e.Text=class{constructor(e){this.selector=e}receive(e){const t=document.querySelector(this.selector);return t&&(t.innerText=String(e)),this}},e.Visible=class{constructor(e){this.selector=e}receive(e){const t=document.querySelector(this.selector);return t&&(t.style.display=e?"block":"none"),this}}}({},patronOop);
