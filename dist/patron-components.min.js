!function(e,t){"use strict";e.CurrentPage=class{receiving(e){const s=location.href.replace(location.origin,"");return t.give({title:"Loading",url:s},e),e}},e.Input=class{constructor(e,s){this.source=e;const i=document.querySelector(s);this.source.receiving(new t.Patron((e=>{i.value=String(e)}))),i.addEventListener("keyup",(()=>{this.receive(i.value)})),i.addEventListener("change",(e=>{this.receive(i.value)}))}receiving(e){return this.source.receiving(e),this}receive(e){return this.source.receive(e),this}},e.Navigation=class{constructor(e,t,s,i,r,c){this.loading=e,this.basePath=t,this.currentPage=s,this.newPage=i,this.display=r,this.pageTransport=c}page(e){this.basePath.receiving((t=>{this.newPage.receive({url:`${t}${e}`,title:"Идет загрузка",data:{url:`${t}${e}`,date:Date.now()}})}))}routes(e){const s=e.find((e=>e.default));this.firstLoad((()=>{this.currentPage.page(new t.Patron((t=>{this.loading.receive(!0),this.basePath.receiving((i=>{i=i.replace("/#","");let r="/"===t.url?i+"/":t.url;r=r.replace("#","").replace("//","/");let c=e.find((e=>i+e.url===r));!c&&s&&(c=s),c&&this.pageTransport.create(i,c.template).content((e=>{this.display.display(e),c.page.mounted(),this.loading.receive(!1)}))}))})))}))}firstLoad(e){const s=new t.GuestChain;this.basePath.receiving(s.receiveKey("basePath")),this.currentPage.page(s.receiveKey("currentPage")),s.result((()=>{t.give(null,e)}))}},e.Page=class{constructor(e){this.title=e}mounted(){document.title=this.title}},e.PageFetchTransport=class{constructor(e,t){this.basePath=e,this.template=t}content(e){fetch(this.basePath+"/"+this.template).then((e=>e.text())).then((s=>{t.give(s,e)}))}},e.RouteDisplay=class{constructor(e){this.selector=e}display(e){const t=document.querySelector(this.selector);t&&(t.innerHTML=e)}},e.Text=class{constructor(e){this.selector=e}receive(e){const t=document.querySelector(this.selector);return t&&(t.innerText=String(e)),this}},e.Visible=class{constructor(e){this.selector=e}receive(e){const t=document.querySelector(this.selector);return t&&(t.style.display=e?"block":"none"),this}}}({},patronOop);
