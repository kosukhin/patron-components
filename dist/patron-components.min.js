!function(e,t){"use strict";var s=Object.defineProperty,r=(e,t,r)=>((e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,t+"",r);e.ClassToggle=class{constructor(e,t){this.toggleClass=e,this.resetClassSelector=t}give(e){return document.querySelectorAll(this.resetClassSelector).forEach((e=>{e.classList.remove(this.toggleClass)})),e.classList.add(this.toggleClass),this}},e.ComputedElement=class{constructor(e,t){this.sources=e,this.selectorTemplate=t}element(e){const s=new t.SourceAll;this.sources.forEach((r=>{r.source.value(new t.GuestCast(e,s.guestKey(r.placeholder)))})),s.value(new t.GuestCast(e,(s=>{let r=this.selectorTemplate;Object.entries(s).map((e=>{r=r.replaceAll(e[0],e[1])}));const i=document.querySelector(r);i&&t.give(i,e)})))}},e.CurrentPage=class{constructor(){r(this,"source");const e=location.href.replace(location.origin,"");this.source=new t.SourceWithPool(e)}give(e){return this.source.give(e),this}value(e){return this.source.value(e),e}pool(){return this.source.pool()}},e.EntryPointPage=class{constructor(e,t){this.title=e,this.entryPointUrl=t}mounted(){document.title=this.title,import(this.entryPointUrl).then((e=>{e.main&&e.main()}))}},e.Input=class{constructor(e,s){this.source=e;const r=document.querySelector(s);this.source.value(new t.Patron((e=>{r.value=String(e)}))),r.addEventListener("keyup",(()=>{this.give(r.value)})),r.addEventListener("change",(()=>{this.give(r.value)}))}value(e){return this.source.value(e),this}give(e){return this.source.give(e),this}pool(){return this.source.pool()}},e.Link=class{constructor(e,t){this.linkSource=e,this.basePath=t}watchClick(e,t){const s=document.querySelectorAll(e);if(!s.length)throw new Error(`Link wrapper not found for selector ${e}`);s.forEach((e=>{e.addEventListener("click",(s=>{t?e.querySelectorAll(t).forEach((e=>{s?.target!==e&&s?.currentTarget!==e||this.handleClick({preventDefault:s.preventDefault.bind(s),target:e})})):this.handleClick(s)}))}))}handleClick(e){let s=e?.target?.getAttribute("href");s||(s=e?.currentTarget?.getAttribute("href")),s&&0!==s.indexOf("http")&&(e.preventDefault(),t.value(this.basePath,(e=>{this.linkSource.give(e+s)})))}},e.Navigation=class{constructor(e,t,s,r,i){this.loading=e,this.basePath=t,this.currentPage=s,this.display=r,this.pageTransport=i}routes(e){const s=e.find((e=>e.default)),r=new t.GuestAwareAll;this.basePath.value(new t.Patron(r.guestKey("basePath"))),this.currentPage.value(new t.Patron(r.guestKey("currentPage"))),r.value(new t.Patron((({basePath:t,currentPage:r})=>{const i=r.replace(t,""),l=e.find((e=>e.aliases&&(e.aliases.includes(r)||e.aliases.includes(i))));if(l){const e=t+l.url;if(e!==r)return void this.currentPage.give(e)}let n=e.find((e=>{if(e.url.indexOf("*")>=0){return new RegExp(e.url.replaceAll("*",".*").replaceAll("/","/")).test(i)}return e.url.replaceAll("*","")===i}));if(!n&&s&&(n=s),!n)throw new Error("No matching route in Navigation");{const e=t.replace("/#","");this.loading.give(!0),this.pageTransport.get(e,n.template).content((e=>{this.display.display(e),n.page.mounted(),this.loading.give(!1)}))}})))}},e.Page=class{constructor(e){this.title=e}mounted(){document.title=this.title}},e.PageFetchTransport=class{constructor(e,t){this.basePath=e,this.template=t}content(e){fetch(this.basePath+"/"+this.template).then((e=>e.text())).then((s=>{t.give(s,e)}))}},e.RouteDisplay=class{constructor(e){this.selector=e}display(e){const t=document.querySelector(this.selector);t&&(t.innerHTML=e)}},e.Text=class{constructor(e){this.selector=e}give(e){const t=document.querySelector(this.selector);return t&&(t.innerText=String(e)),this}},e.Visible=class{constructor(e){this.selector=e}give(e){const t=document.querySelector(this.selector);return t&&(t.style.display=e?"block":"none"),this}}}({},patronOop);
