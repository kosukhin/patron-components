!function(e,t){"use strict";e.PageFetchTransport=class{constructor(e,t){this.basePath=e,this.template=t}content(e){fetch(this.basePath+"/"+this.template).then((e=>e.text())).then((s=>{t.give(s,e)}))}},e.Route=class{constructor(e,t,s,a,i,r){this.loading=e,this.basePath=t,this.currentPage=s,this.newPage=a,this.display=i,this.pageTransport=r}page(e){this.basePath.receiving((t=>{this.newPage.receive({url:`${t}${e}`,title:"Идет загрузка",data:{url:`${t}${e}`,date:(new Date).getTime()}})}))}routes(e){const s=e.find((e=>e.default));this.firstLoad((()=>{this.currentPage.page(new t.Patron((t=>{this.loading.receive(!0),this.basePath.receiving((a=>{a=a.replace("/#","");let i="/"===t.url?a+"/":t.url;i=i.replace("#","").replace("//","/");let r=e.find((e=>a+e.url===i));!r&&s&&(r=s),r&&this.pageTransport.create(a,r.template).content((e=>{this.display.display(e),r.page.mounted(),this.loading.receive(!1)}))}))})))}))}firstLoad(e){const s=new t.GuestChain;this.basePath.receiving(s.receiveKey("basePath")),this.currentPage.page(s.receiveKey("currentPage")),s.result((()=>{t.give(null,e)}))}},e.RouteDisplay=class{constructor(e){this.selector=e}display(e){const t=document.querySelector(this.selector);t&&(t.innerHTML=e)}}}({},patronOop);
