!function(e,t){"use strict";class a{constructor(e,t,a){this.basePath=e,this.currentPage=t,this.newPage=a}page(e){this.basePath.receiving((t=>{this.newPage.receive({url:`${t}${e}`,title:"Идет загрузка",data:{url:`${t}${e}`,date:(new Date).getTime()}})}))}handleRoutes(e,a){const i=document.querySelector(e),r=a.find((e=>e.default));this.firstLoad((()=>{this.currentPage.page(new t.Patron((e=>{this.basePath.receiving((t=>{t=t.replace("/#","");let n="/"===e.url?t+"/":e.url;n=n.replace("#","").replace("//","/");let s=a.find((e=>t+e.url===n));!s&&r&&(s=r),s&&fetch(t+"/"+s.template).then((e=>e.text())).then((e=>{i&&(i.innerHTML=e),s.page?.mounted()}))}))})))}))}firstLoad(e){const a=new t.GuestChain;this.basePath.receiving(a.receiveKey("basePath")),this.currentPage.page(a.receiveKey("currentPage")),a.result((({basePath:a,currentPage:i})=>{const r=location.href.replace(location.origin,"");i.url!==r&&(this.page(r.replace(a,"")),setTimeout((()=>{t.give(null,e)})))}))}}globalThis&&(globalThis.GUEST_LIBRARY||(globalThis.GUEST_LIBRARY={}),globalThis.GUEST_LIBRARY.components={Route:a}),e.Route=a}({},patronOop);
